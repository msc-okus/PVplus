<div class="grid-x" data-action="ticket-split:async:submitted->ticket-edit#reload" >
    <div class="cell small-12 is-hidden"
         style="background-color: red"
         data-ticket-edit-target="AlertFormat"
    >
        Error with the format of the date, it is
        quarter based.
    </div>
    <div class="cell small-12 is-hidden"
         style="background-color: red"
         data-ticket-edit-target="AlertDates"
    >
        Error, end date can not be before or equal the beginning
    </div>
    <div class="cell">
        {{ form_start(ticketForm) }}
        <div id="ticket-edit" class="grid-x">
            <div class="cell">
                <div class="content">
                    {% if (edited) %}
                        {% set dropdownId = ticketForm.vars.value.id %}
                        {% set openTicket = ticketForm.vars.value.openTicket %}
                    {% else %}
                        {% set dropdownId = '00' %}
                        {% set openTicket = '' %}
                    {% endif %}
                    <fieldset class="fieldset">
                        <legend>Base Info {% if (openTicket) %} (Ticket open) {% endif %}</legend>
                        {% set counter = 0 %}
                        {% for inverter in invArray %}
                            {% if (inverter['select'] == "checked") %}
                                {% set counter = counter + 1 %}
                            {% endif %}
                        {% endfor %}
                        <div class="grid-x grid-margin-x grid-padding-x">
                            {# Split by Inverter stuff #}
                            {% if (is_granted('ROLE_G4N') or is_granted('ROLE_BETA')) %}
                                <button class="button small no-margin hollow expanded" type="button"  {% if (edited) %}data-toggle="split-dropdown-{{ dropdownId }}"{% else %} disabled{% endif %}{% if (counter <= 1)%} disabled {% endif%} data-ticket-edit-target="splitDeploy">Split by Inverter</button>
                                <div class="dropdown-pane shadow"   {% if (edited) %}id="split-dropdown-{{ dropdownId }}" {% else%} disabled {% endif %}data-dropdown data-auto-focus="true" data-alignment="center" data-close-on-click="true">
                                    {% if (invArray != null) %}
                                        <div class="grid-x">
                                            <div class="cell small-12 "
                                                 style="background-color: red"
                                                 data-ticket-edit-target="splitAlert"
                                            >
                                                No inverters in one of the Tickets
                                            </div>
                                            <div class="cell">
                                                <h3>Inverter List</h3>
                                            </div>
                                        </div>
                                        <h4>This Ticket</h4>
                                        <div class="grid-x small-up-3 medium-up-6 large-up-6 xlarge-up-9">
                                            {% for inverter in invArray %}
                                                {% if (inverter['select'] == "checked") %}
                                                    <div class="cell js-div-split-a" id="div-split-{{ loop.index  }}a">
                                                        <label for="split-{{ loop.index }}a" class="">{{ inverter['inv'] }}
                                                            <input id="split-{{ loop.index }}a" type="checkbox" class="js-checkbox-split-a" name="{{ loop.index }}" {{ inverter['select'] }}  data-ticket-edit-id-param="{{ loop.index }}"data-action="click->ticket-edit#checkInverterSplit1">
                                                        </label>
                                                    </div>
                                                {% else  %}
                                                    <div class="cell js-div-split-a is-hidden" id="div-split-{{ loop.index  }}a">
                                                        <label for="split-{{ loop.index }}a" class="">{{ inverter['inv'] }}
                                                            <input id="split-{{ loop.index  }}a" type="checkbox" class="js-checkbox-split-a" name="{{ loop.index }}"  {{ inverter['select'] }} data-ticket-edit-id-param="{{ loop.index }}" data-action="click->ticket-edit#checkInverterSplit1">
                                                        </label>
                                                    </div>
                                                {% endif %}
                                            {% endfor %}
                                        </div>
                                        <hr>
                                        <h4>New Ticket</h4>
                                        <div class="grid-x small-up-3 medium-up-6 large-up-6 xlarge-up-9">
                                            {% for inverter in invArray %}
                                                {% if (inverter['select'] == "checked") %}
                                                    <div class="cell js-div-split-b" id="div-split-{{ loop.index}}b">
                                                        <label for="split-{{ loop.index }}b" class="">{{ inverter['inv'] }}
                                                            <input id="split-{{ loop.index }}b" type="checkbox" class="js-checkbox-split-b" name="{{ loop.index }}" data-ticket-edit-id-param="{{ loop.index }}" data-action="click->ticket-edit#checkInverterSplit2">
                                                        </label>
                                                    </div>
                                                {% else  %}
                                                    <div class="cell js-div-split-b is-hidden" id="div-split-{{ loop.index}}b">
                                                        <label for="split-{{ loop.index }}b" class="">{{ inverter['inv'] }}
                                                            <input id="split-{{ loop.index}}b" type="checkbox" class="js-checkbox-split-b" name="{{ loop.index }}" data-ticket-edit-id-param="{{ loop.index }}" data-action="click->ticket-edit#checkInverterSplit2">
                                                        </label>
                                                    </div>
                                                {% endif %}
                                            {% endfor %}
                                        </div>
                                        <button type="button" class="button small"  data-ticket-edit-target="splitButton" {% if (edited) %}data-ticket-edit-ticketid-param="{{ ticket.id }}" disabled data-action="ticket-edit#splitTicketByInverter" {% endif %}>Split</button>
                                    {% else %}
                                        No Inverters found to select
                                    {% endif %}
                                </div>
                            {% endif %}

                            <div class="cell small-12 medium-3 large-2">
                                {{ form_row(ticketForm.anlage, {'attr': {'value': anlage.anlName } }) }}
                            </div>
                            <div class="cell small-6 medium-3 large-2">
                                {# Select inverter stuff #}
                                {% if (is_granted('ROLE_G4N') or is_granted('ROLE_BETA')) %}
                                    <div class="grid-x">
                                        <div class="cell">
                                            <label>&nbsp;</label>
                                            <button class="button small no-margin hollow expanded" type="button" data-toggle="inverter-dropdown-{{ dropdownId }}">Select Inverters</button>
                                            <div class="dropdown-pane shadow" id="inverter-dropdown-{{ dropdownId }}" data-dropdown data-auto-focus="true" data-alignment="center" data-close-on-click="true">
                                                {% if (invArray != null) %}
                                                    <div class="grid-x">
                                                        <div class="cell">
                                                            <h3>Inverter List</h3>
                                                            <label for="check-all" class="">Select All
                                                                <input id="check-all" type="checkbox"  {% if (edited) %}data-ticket-edit-edited-param="true" {% else %} data-ticket-edit-edited-param="false" {% endif %} data-action="click->ticket-edit#checkSelect" data-ticket-edit-target="switch">
                                                            </label>
                                                        </div>
                                                    </div>
                                                    <div class="grid-x small-up-3 medium-up-6 large-up-9 xlarge-up-12">
                                                        {% for inverter in invArray %}
                                                            <div class="cell">
                                                                <label for="{{ inverter['inv'] }}" class="">{{ inverter['inv'] }}
                                                                    <input id="{{ inverter['inv'] }}" type="checkbox" class="js-checkbox" name="{{ loop.index }}" {{ inverter['select'] }} {% if (edited) %}data-ticket-edit-edited-param="true" {% else %} data-ticket-edit-edited-param="false" {% endif %} data-action="click->ticket-edit#checkInverter">
                                                                </label>
                                                            </div>
                                                        {% endfor %}
                                                    </div>
                                                {% else %}
                                                    No Inverters found to select
                                                {% endif %}
                                            </div>

                                        </div>
                                    </div>
                                {% endif %}
                            </div>
                            <div class="cell small-6 medium-3 large-2">
                                {{ form_row(ticketForm.inverter) }}
                            </div>
                            <div class="cell small-6 medium-3 large-2">
                                {{ form_row(ticketForm.needsProof) }}
                            </div>
                            <div class="cell small-6 medium-3 large-2">
                                {{ form_row(ticketForm.begin) }}
                            </div>
                            <div class="cell small-6 medium-3 large-2">
                                {{ form_row(ticketForm.end) }}
                            </div>
                        </div>
                        <div class="grid-x grid-margin-x grid-padding-x">
                            <div class="cell small-3">
                                {{ form_row(ticketForm.status) }}
                            </div>
                            <div class="cell small-3">
                                {{ form_row(ticketForm.priority) }}
                            </div>
                            <div class="cell small-3">
                                {{ form_row(ticketForm.alertType) }}
                            </div>
                            <div class="cell small-3"> {# type = errorType (Bsp:  SFOR, EFOR, OMC) #}
                                {{ form_row(ticketForm.errorType) }}
                            </div>
                        </div>
                        <div class="grid-x grid-margin-x grid-padding-x">

                        </div>
                        {% include 'ticket/_inc/_ticketDatesList.html.twig' %}
                    </fieldset>

                    <fieldset class="fieldset">
                        <legend>Descriptions</legend>
                        <div class="grid-x grid-margin-x grid-padding-x">
                            <div class="cell medium-12 small-12">
                                {% if (edited) %}
                                    <div class="callout warning">{{ ticket.description|default('')|raw }}</div>
                                {% endif %}
                                {{ form_row(ticketForm.freeText) }}
                                {{ form_row(ticketForm.answer) }}
                            </div>

                        </div>
                    </fieldset>

                    {% if (is_granted('ROLE_G4N')) %}
                        <div data-controller="hide">
                            <div class="switch tiny cell medium-3 small-6">
                                <label>Show effects on ...</label>
                                <input class="switch-input" id="exampleSwitch" type="checkbox" name="exampleSwitch"
                                       data-action="click->hide#change" data-hide-target="switch">
                                <label class="switch-paddle" for="exampleSwitch">
                                    <span class="show-for-sr"></span>
                                </label>
                            </div>
                            <br class="clearfix">
                            <fieldset id="midiv" class="fieldset" data-hide-target="area">
                                <div class="grid-x grid-margin-x grid-padding-x">
                                    <div class="cell small-12">
                                        <h4>This ticket effects on the following calculations:</h4>
                                        <table>
                                            <thead>
                                            <tr>
                                                <td>EPC</td>
                                                <td>O&M</td>
                                                <td>AM</td>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr>
                                                <td>{{ form_row(ticketForm.PR0) }}</td>
                                                <td>{{ form_row(ticketForm.PR1) }}</td>
                                                <td>{{ form_row(ticketForm.PR2) }}</td>
                                            </tr>
                                            <tr>
                                                <td>{{ form_row(ticketForm.PA0C5) }}</td>
                                                <td>{{ form_row(ticketForm.PA1C5) }}</td>
                                                <td>{{ form_row(ticketForm.PA2C5) }}</td>
                                            </tr>
                                            <tr>
                                                <td>{{ form_row(ticketForm.PA0C6) }}</td>
                                                <td>{{ form_row(ticketForm.PA1C6) }}</td>
                                                <td>{{ form_row(ticketForm.PA2C6) }}</td>
                                            </tr>
                                            <tr>
                                                <td>{{ form_row(ticketForm.Yield0) }}</td>
                                                <td>{{ form_row(ticketForm.Yield1) }}</td>
                                                <td>{{ form_row(ticketForm.Yield2) }}</td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </fieldset>
                        </div>
                    {% endif %}

                </div>
            </div>


        </div>
        <div style="display: none">{{ form_rest(ticketForm) }}</div>
        {{ form_end(ticketForm) }}
    </div>
</div>