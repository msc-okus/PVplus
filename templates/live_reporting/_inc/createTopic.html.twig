{% block header %}
	<script src="https://code.jquery.com/jquery-3.7.0.js"></script>
	<script>
		$(function () {
			let daysInMonth = $('#createTopic_daysinmonth').val();

			$("[name='createTopic']").submit(function(e) {
				$('#createTopic_issm').val(2);
			});
			let isSubmitted = $('#createTopic_issm').val();


				$('#createTopic_startDay').on('change', function (e) {
					let optionSelected = $("option:selected", this);
					let startDay = parseInt(this.value);
					let restDays = daysInMonth - startDay;

					startDay = startDay + 1;
					$('#createTopic_endDay').empty();
					$('#createTopic_endDay').append($('<option>', {
						value: 0,
						text : 'please choose',
						selected: true
					}));
					let i = startDay;
					while (i <= daysInMonth) {
						$('#createTopic_endDay').append($('<option>', {
							value: i,
							text : i
						}));
						i++;
					}
				});




	});
	</script>
{% endblock %}
{% block form %}
	{% set routeParams = app.request.query.all() | merge(app.request.attributes.get('_route_params')) %}
	{% if flow.isAllowDynamicStepNavigation() %}
		{% set routeParams = routeParams | craue_removeDynamicStepNavigationParameters(flow) %}
	{% endif %}

	{{ form_start(form, {'action': path(app.request.attributes.get('_route'), routeParams), 'attr': {'class': 'flow-form'}}) }}
		<fieldset>
			<legend>{{ 'step' | trans }} {{ flow.getCurrentStepNumber() }}: {{ flow.getCurrentStepLabel() | trans }}</legend>
			{{ form_errors(form) }}

			{% if flow.getCurrentStepNumber() == 3 %}
				{{ 'bug_details_intro' | trans }}
				<br /><br />
				{{ form_row(form.details) }}
			{% endif %}

			{% if flow.getCurrentStepNumber() == 4 %}
				{{ 'confirmation_intro' | trans }}
				<br />
				<dl>
					<dt>{{ 'year' | trans }}:</dt>
					<dd>{{ formData.year }}</dd>

					<dt>{{ 'month' | trans }}:</dt>
					<dd>{{ formData.month |  trans({}, 'topicPlants') }}</dd>

					<dt>{{ 'anlage' | trans }}:</dt>
					<dd>{{ formData.anlage | trans({}, 'topicPlants') }}</dd>

					<dt>{{ 'startday' | trans }}:</dt>
					<dd>{{ formData.startDay |  trans({}, 'topicPlants') }}</dd>

					<dt>{{ 'endday' | trans }}:</dt>
					<dd>{{ formData.endDay |  trans({}, 'topicPlants') }}</dd>


					{% if formData.isBugReport() %}
						<dt>{{ 'details' | trans }}:</dt>
						<dd>{{ formData.details | nl2br }}</dd>
					{% endif %}
				</dl>
			{% endif %}

			{{ form_rest(form) }}
		</fieldset>

	{% include '@CraueFormFlow/FormFlow/buttons.html.twig' with {
		craue_formflow_button_class_last: 'btn btn-primary',
		craue_formflow_button_class_back: 'btn_back',
		craue_formflow_button_class_reset: 'btn btn-warning',
		craue_formflow_button_class_next: 'btn_next',
		craue_formflow_button_class_finish: 'submit',
		craue_formflow_button_label_finish: 'submit',
		craue_formflow_button_label_reset: 'Start over',
	} %}
	{{ form_end(form) }}
{% endblock %}
